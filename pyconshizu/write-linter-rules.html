<!DOCTYPE html>

<html lang="ja" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Pythonã®ãƒªãƒ³ã‚¿ã‚’ä½œã‚ã†</title>
    <link rel="stylesheet" type="text/css" href="../_static/revealjs/dist/reveal.css?v=d4488b42" />
    <link rel="stylesheet" href="../_static/revealjs/dist/theme/black.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/revealjs/plugin/highlight/zenburn.css?v=83d5745d" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/common.css?v=b04cc698" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-revealjs/css/footnotes.css?v=c46a0db2" />
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">


    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@ftnext">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://ftnext.github.io/2026-slides/pyconshizu/write-linter-rules.html">
    <meta property="og:title" content="Pythonã®ãƒªãƒ³ã‚¿ã‚’ä½œã‚ã†">
    <meta property="og:description" content="PyCon mini Shizuoka 2026">
    <meta property="og:image" content="https://ftnext.github.io/2026-slides/_static/ogps/pyconshizu.png">

  </head><body>
    <div class="reveal">
        <div class="slides" role="main">
            <section>
<section>
<h1 style="word-break: keep-all; overflow-wrap: break-word;">Pythonã®ãƒªãƒ³ã‚¿ã‚’ä½œã‚ã†</h1>
<dl class="field-list simple">
<dt class="field-odd">Event<span class="colon">:</span></dt>
<dd class="field-odd"><p>PyCon mini Shizuoka 2026</p>
</dd>
<dt class="field-even">Presented<span class="colon">:</span></dt>
<dd class="field-even"><p>2026/02/21 nikkie</p>
</dd>
</dl>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">è¨‚æ­£ï¼šãƒªãƒ³ã‚¿ã® <strong>ãƒ«ãƒ¼ãƒ«</strong> ã‚’ä½œã‚ã†</h2>
<ul class="simple">
<li><p>ãƒ—ãƒ­ãƒãƒ¼ã‚¶ãƒ«ã®ã‚¿ã‚¤ãƒˆãƒ«ãŒæœ¬æ–‡ã‚’åæ˜ ã—ã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚ã”ã‚ã‚“ãªã•ã„ <a class="footnote-reference brackets" href="#build-python-linter-first-step" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></li>
<li><p>ä¸»å¼µï¼šPythonã®ãƒªãƒ³ã‚¿ã® <strong>ãƒ«ãƒ¼ãƒ«ã‚’æ›¸ã‘ã‚‹</strong> ã‚ˆã†ã«ãªã£ã¦ã€ã‚ˆã‚Šä½¿ã„ã“ãªã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼ˆ<span class="fab fa-github"></span> <a class="reference external" href="https://github.com/ftnext/2026-slides/tree/main/samplecode/write-python-linter-rules" rel="noreferrer" target="_blank">ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰</a>ï¼‰</p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="build-python-linter-first-step" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id2" role="doc-backlink">1</a><span class="fn-bracket">]</span></span>
<p>ã›ã‚ã¦ã‚‚ã®ãŠè©«ã³ã¨ã—ã¦æ‹™ãƒ–ãƒ­ã‚° <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/entry/my-first-python-linter-based-on-flake8-observation-first-step" rel="noreferrer" target="_blank">flake8 ã‚’è¦³å¯Ÿã—ã¦ä½œã‚‹ã€å°ã•ãª Python ãƒªãƒ³ã‚¿ï¼ˆä¸€æ­©ç›®ï¼‰</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">çš†ã•ã¾ãŠä½¿ã„ã®ãƒªãƒ³ã‚¿ã¯ï¼Ÿ</h3>
<ul class="simple">
<li><p>Ruff</p></li>
<li><p>flake8</p></li>
<li><p>pylint</p></li>
</ul>
<p>å¯¾è±¡ï¼šä»•çµ„ã¿ã¯åˆ†ã‹ã‚‰ãªã„ãŒã€1ã¤ã§ã‚‚ <strong>å‹•ã‹ã—ãŸã“ã¨ãŒã‚ã‚‹</strong></p>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">ãŠå‰ã€èª°ã‚ˆ</h2>
<ul class="simple">
<li><p>nikkieï¼ˆã«ã£ããƒ¼ï¼‰ãƒ»Pythonæ­´8å¹´ãƒ»<a class="reference external" href="https://nikkie-ftnext.hatenablog.com/" rel="noreferrer" target="_blank">ãƒ–ãƒ­ã‚°</a> é€£ç¶š1100æ—¥çªç ´</p></li>
<li><p>æ©Ÿæ¢°å­¦ç¿’ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã€‚ <a class="reference external" href="https://jp.ub-speeda.com/news/speeda-promotion-gallery/" rel="noreferrer" target="_blank">Speeda AI Agent</a> é–‹ç™ºï¼ˆ<a class="reference external" href="https://hrmos.co/pages/uzabase/jobs/1829077236709650481" rel="noreferrer" target="_blank">We're hiring!</a>ï¼‰</p></li>
</ul>
<img alt="../_images/uzabase-white-logo.png" src="../_images/uzabase-white-logo.png"/>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><strong>æ‹¡å¼µ</strong> ã§ãã‚‹ã‚‚ã®ãŒå¥½ã</h3>
<ul class="simple">
<li><p>å…¬é–‹ã—ã¦ã„ã‚‹ flake8 ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ <span class="fab fa-github"></span> <a class="reference external" href="https://github.com/ftnext" rel="noreferrer" target="_blank">@ftnext</a></p>
<ul>
<li><p><a class="reference external" href="https://pypi.org/project/flake8-kotoha/" rel="noreferrer" target="_blank">flake8-kotoha</a></p></li>
<li><p><a class="reference external" href="https://pypi.org/project/happy-python-logging/" rel="noreferrer" target="_blank">happy-python-logging</a></p></li>
</ul>
</li>
<li><p>Ruff ä½¿ã£ã¦ã¾ã™ï¼ˆé€Ÿã• &amp; ç°¡å˜ã•ï¼‰</p></li>
</ul>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">å°å…¥ï¼šã‚ãªãŸã¯ãƒªãƒ³ã‚¿ã®ãƒ«ãƒ¼ãƒ«ã‚’æ›¸ããŸããªã‚‹</h2>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰ <a class="reference external" href="https://peps.python.org/pep-0008/" rel="noreferrer" target="_blank">PEP 8</a></h3>
<ul>
<li><p>è¦‹ãŸç›®ã«ã¤ã„ã¦ï¼ˆä¾‹ï¼šæ¼”ç®—å­ã¨åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ï¼‰ <a class="footnote-reference brackets" href="#formatter" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p></li>
<li><p>ã“ã®ã‚ˆã†ãªPythonã‚’ <strong>æ›¸ã„ã¦ã¯ã„ã‘ã¾ã›ã‚“</strong> ï¼ˆä»£ã‚ã‚Šã«ã“ã†æ›¸ãã¾ã—ã‚‡ã†ï¼‰</p>
<blockquote>
<div><ul class="simple">
<li><p>ã“ã®ãƒˆãƒ¼ã‚¯ã§ãƒªãƒ³ã‚¿ãŒæŒ‡ã—ã¦ã„ã‚‹ã®ã¯ã“ã¡ã‚‰</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="formatter" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id8" role="doc-backlink">2</a><span class="fn-bracket">]</span></span>
<p>ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ã¨å‘¼ã°ã‚Œã‚‹ãƒ„ãƒ¼ãƒ«ã®å‡ºç•ªã§ã™ã­</p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ä¾‹ã€Œã“ã®ã‚ˆã†ã«æ›¸ã„ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€ <a class="footnote-reference brackets" href="#b012" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></h3>
<div class="literal-block-wrapper docutils container" id="id63">
<div class="code-block-caption"><span class="caption-text">ã¶ã£ã¶ãƒ¼ã§ã™ã‚ğŸ™…â€â™€ï¸</span></div>
<pre><code class="python" data-noescape="" data-trim="">def foo():
    try:
        1 / 0
    finally:
        return 42</code></pre>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="b012" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id9" role="doc-backlink">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://docs.astral.sh/ruff/rules/jump-statement-in-finally/" rel="noreferrer" target="_blank">jump-statement-in-finally (B012)</a> ï¼ˆæ‹™ãƒ–ãƒ­ã‚° <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/entry/whatsnew-python-314-pep-765-syntaxwarning-finally-return" rel="noreferrer" target="_blank">ã€ŒWhat's new in Python 3.14ã€ã‚ˆã‚Š finally ç¯€ã§ã® returnï¼ˆã‚„ continueãƒ»breakï¼‰ã¯ SyntaxWarning ã§è­¦å‘Šã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼ˆPEP 765ï¼‰</a>ï¼‰</p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">PEP 8 ä»¥å¤–ã®ä¾‹ï¼šãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«f-stringã¯ã„ã‘ã¾ã›ã‚“ <a class="footnote-reference brackets" href="#g004" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a></h3>
<div class="literal-block-wrapper docutils container" id="id64">
<div class="code-block-caption"><span class="caption-text">ã¶ã£ã¶ãƒ¼ã§ã™ã‚ğŸ™…â€â™€ï¸</span></div>
<pre><code class="python" data-noescape="" data-trim="">logger.info(f"{user} - Something happened")</code></pre>
</div>
<div class="literal-block-wrapper docutils container" id="id65">
<div class="code-block-caption"><span class="caption-text">ãƒ­ã‚®ãƒ³ã‚°ã§ã¯ <strong>%æ¼”ç®—å­ã«ã‚ˆã‚‹æ›¸å¼åŒ–</strong></span></div>
<pre><code class="python" data-noescape="" data-trim="">logger.info("%s - Something happened", user)</code></pre>
</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="g004" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id11" role="doc-backlink">4</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://docs.astral.sh/ruff/rules/logging-f-string/" rel="noreferrer" target="_blank">logging-f-string (G004)</a> ï¼ˆæ‹™ãƒ–ãƒ­ã‚° <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/entry/hey-claude-dont-use-f-string-in-logging-messages" rel="noreferrer" target="_blank">Pythonã®ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«f-stringã¯ã„ã‘ã¾ã›ã‚“ã€‚ãã“ã®Claudeã€ç§ã¯ã‚ãªãŸã«è¨€ã£ã¦ã„ã‚‹ã‚“ã§ã™ã‚ˆ</a>ï¼‰</p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰ã¯ãƒªãƒ³ã‚¿ã«ãƒã‚§ãƒƒã‚¯ã•ã›ã‚ˆã†</h3>
<ul class="simple">
<li><p>äººé–“ã¯å…¨ã¦ã®ãƒ«ãƒ¼ãƒ«ã‚’è¦šãˆã¦ã„ã‚‰ã‚Œãªã„</p></li>
<li><p>æ›¸ã„ã¦ã¯ã„ã‘ãªã„Pythonã® <strong>æŒ‡æ‘˜ã‚’ãƒªãƒ³ã‚¿ã«ä»»ã›ã‚‹</strong></p></li>
<li><p>åŠ¹èƒ½ï¼šã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ç„¦ç‚¹ãŒã‚¹ã‚¿ã‚¤ãƒ«ã‹ã‚‰æœ¬è³ªçš„ãªãƒ­ã‚¸ãƒƒã‚¯ã¸</p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ãƒªãƒ³ã‚¿ã‚’æŒãŸã›ã‚‹</h3>
<ul>
<li><p>IMOï¼šLLMã¯ï¼ˆæ€§èƒ½å‘ä¸Šã¯ç”šã ã—ã„ãŒï¼‰Pythonã‚’ååˆ†ã«ã¯ç†è§£ã—ã¦ã„ãªã„</p>
<blockquote>
<div><ul class="simple">
<li><p>ä¾‹ï¼šå…ˆã®ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®f-string</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>ãƒ•ãƒƒã‚¯æ©Ÿèƒ½ã§ãƒªãƒ³ã‚¿ã‚’çµ„ã¿è¾¼ã¿</strong> ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰ã‚’å¼·åˆ¶ã™ã‚‹ <a class="footnote-reference brackets" href="#yapc-fukuoka-lt" id="id14" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a></p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="yapc-fukuoka-lt" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id14" role="doc-backlink">5</a><span class="fn-bracket">]</span></span>
<p>YAPCã§ã®LTğŸ… <a class="reference external" href="https://ftnext.github.io/2025-slides/yapc-fukuoka/lt-agent-who-understand-python.html#/2" rel="noreferrer" target="_blank">Pythonã‚’"ç†è§£"ã—ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒæ¬²ã—ã„ï¼ï¼</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ã€ŒæŒ‡æ‘˜ã—ãŸã„ãƒ«ãƒ¼ãƒ«ãŒèª°ã«ã‚‚å…¬é–‹ã•ã‚Œã¦ã„ãªã„ã€å•é¡Œ</h3>
<ul class="simple">
<li><p>ãƒªãƒ³ãƒˆãƒ«ãƒ¼ãƒ«ã¯ 800 ä»¥ä¸Šã‚ã‚‹ãŒã€è‡ªåˆ†ãŒæ¬²ã—ã„ãƒ«ãƒ¼ãƒ«ãŒå­˜åœ¨ã—ãªã„ã“ã¨ãŒã‚ã‚‹</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id66">
<div class="code-block-caption"><span class="caption-text">ã“ã®å‹ãƒ’ãƒ³ãƒˆã«ã¯ä¼¸ã³ã—ã‚ãŒã‚ã‚‹</span></div>
<pre><code class="python" data-noescape="" data-trim="">def plus_one_ng(numbers: list[int]) -&gt; list[int]:
    return [n + 1 for n in numbers]</code></pre>
</div>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">å¼•æ•°ã®å‹ãƒ’ãƒ³ãƒˆã‚’listã«ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“</h3>
<div class="literal-block-wrapper docutils container" id="id67">
<div class="code-block-caption"><span class="caption-text">listä»¥å¤–ã‚’æ¸¡ã—ã¦ã‚‚å‹•ãã¾ã™</span></div>
<pre><code class="python" data-noescape="" data-trim="">plus_one_ng((1, 2, 3))  # collections.abc.Sequence
plus_one_ng(range(3))   # collections.abc.Iterable</code></pre>
</div>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><a class="reference external" href="https://docs.python.org/ja/3/library/typing.html#typing.List" rel="noreferrer" target="_blank">typing.List</a> ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚ˆã‚Š</h3>
<blockquote>
<div><p>Note that to annotate arguments, it is preferred to use an abstract collection type such as <code class="docutils literal notranslate"><span class="pre">Sequence</span></code> or <code class="docutils literal notranslate"><span class="pre">Iterable</span></code> rather than to use <code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">typing.List</span></code>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code> ã‚„ <code class="docutils literal notranslate"><span class="pre">collections.abc.Iterable</span></code> ãªã©ã® <strong>æŠ½è±¡</strong> å‹ãŒå¥½ã¾ã—ã„</p>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><a class="reference external" href="https://pypi.org/project/flake8-kotoha/" rel="noreferrer" target="_blank">flake8-kotoha</a> ã‚’è‡ªä½œã—ã¾ã—ãŸ</h3>
<pre data-id="id17"><code class="console" data-noescape="" data-trim="">$ uvx --with flake8-kotoha flake8 lint-targets/use_iterable.py
lint-targets/use_iterable.py:6:17: KTH101 Type hint with abstract type `collections.abc.Iterable` or `collections.abc.Sequence`, instead of concrete type `list`</code></pre>
<div class="literal-block-wrapper docutils container" id="id68">
<div class="code-block-caption"><span class="caption-text">ã“ã†ã—ã¾ã—ã‚‡ã†</span></div>
<pre><code class="python" data-noescape="" data-trim="">def plus_one_ok(numbers: Iterable[int]) -&gt; list[int]:
    return [n + 1 for n in numbers]</code></pre>
</div>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ãƒ«ãƒ¼ãƒ«ã‚’æ›¸ããŸããªã£ã¦ãã¾ã—ãŸã‚ˆã­ï¼Ÿ</h3>
<p>ã€Œå¼•æ•°ã®å‹ãƒ’ãƒ³ãƒˆã‚’listã«ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€ã‚’ä¾‹ã«</p>
<dl class="field-list simple">
<dt class="field-odd">1. Pythonã§æ›¸ã<span class="colon">:</span></dt>
<dd class="field-odd"><p>ä¾‹ã¨ã—ã¦ <strong>flake8ãƒ—ãƒ©ã‚°ã‚¤ãƒ³</strong></p>
</dd>
<dt class="field-even">2. Ruff ã§ã¯ï¼Ÿ<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>æ„è¦‹</strong> ã‚’ä¼ãˆã‚‹ã®ã§è€ƒãˆã‚‹ãã£ã‹ã‘ã«</p>
</dd>
</dl>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">ãƒªãƒ³ã‚¿ã®ãƒ«ãƒ¼ãƒ«ã‚’Pythonã§æ›¸ã</h2>
<p>ãã®ãŸã‚ã«ã¾ãš2ã¤æŠ¼ã•ãˆã¾ã—ã‚‡ã†</p>
<ul class="simple">
<li><p>æŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆ<em>AST</em>: Abstract Syntax Treeï¼‰</p></li>
<li><p>GoF ã®ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã® <em>Visitor</em></p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ã€Œã“ã®ã‚ˆã†ã«æ›¸ã„ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€ã®å®Ÿè£…</h3>
<ul class="simple">
<li><p>ã€Œæ›¸ã„ã¦ã¯ã„ã‘ãªã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã€ã‚’ASTã§ <strong>è¡¨ç¾</strong></p></li>
<li><p>ãã‚Œã‚’ Visitor ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ <strong>è¦‹ã¤ã‘ã‚‹</strong></p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ãŠã™ã™ã‚ï¼šLintã‚ªã‚¿ã‚¯ã«ã‚ˆã‚‹Lintè§£èª¬ï¼ˆ<a class="reference external" href="https://www.youtube.com/watch?v=gKCB6rQxFBU" rel="noreferrer" target="_blank">Lint Night #1</a>ï¼‰ ğŸƒâ€â™‚ï¸</h3>
<iframe allowfullscreen="true" class="speakerdeck-iframe" data-ratio="1.7777777777777777" frameborder="0" src="https://speakerdeck.com/player/ffeacc49800f47a29172d5d11eecc210" style="border: 0px; background: rgba(0, 0, 0, 0.1) padding-box; margin: 0px; padding: 0px; border-radius: 6px; box-shadow: rgba(0, 0, 0, 0.2) 0px 5px 40px; width: 100%; height: auto; aspect-ratio: 560 / 315;" title="Lintã‚ªã‚¿ã‚¯ã«ã‚ˆã‚‹Lintè§£èª¬ / Introduction to Lints"></iframe></section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">æº–å‚™1ï¸âƒ£ AST</h2>
<ul class="simple">
<li><p>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ <strong>æœ¨æ§‹é€ </strong> ã®ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦è¡¨ç¾ã—ãŸã‚‚ã®</p></li>
<li><p>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒˆãƒ¼ã‚¯ãƒ³ã«åˆ†ã‘ã‚‹ <a class="footnote-reference brackets" href="#python-lexical-analysis" id="id21" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a></p></li>
<li><p>ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ§‹æ–‡ã‚’è¡¨ã™æ§‹é€ ï¼ˆæœ¨ï¼‰ã«å¤‰æ›ã™ã‚‹</p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="python-lexical-analysis" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id21" role="doc-backlink">6</a><span class="fn-bracket">]</span></span>
<p>å­—å¥è§£æ <a class="reference external" href="https://docs.python.org/ja/3/reference/lexical_analysis.html" rel="noreferrer" target="_blank">https://docs.python.org/ja/3/reference/lexical_analysis.html</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã® <code class="docutils literal notranslate"><span class="pre">ast</span></code> ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« <a class="footnote-reference brackets" href="#ast-m" id="id22" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a></h3>
<pre data-id="id23"><code class="default" data-noescape="" data-trim="">$ echo 'print("é™å²¡")' | python -m ast
Module(
   body=[
      Expr(
         value=Call(
            func=Name(id='print', ctx=Load()),
            args=[
               Constant(value='é™å²¡')]))])</code></pre>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="ast-m" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id22" role="doc-backlink">7</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#command-line-usage" rel="noreferrer" target="_blank">https://docs.python.org/ja/3/library/ast.html#command-line-usage</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ASTã«å¤‰æ› <a class="footnote-reference brackets" href="#ast-parse" id="id24" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a> ğŸƒâ€â™‚ï¸</h3>
<pre data-id="id25"><code class="pycon" data-noescape="" data-trim="">&gt;&gt;&gt; import ast
&gt;&gt;&gt; tree = ast.parse('print("é™å²¡")')</code></pre>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="ast-parse" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id24" role="doc-backlink">8</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#ast.parse" rel="noreferrer" target="_blank">https://docs.python.org/ja/3/library/ast.html#ast.parse</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ASTã‚’è¡¨ç¤º <a class="footnote-reference brackets" href="#ast-dump" id="id26" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a> ğŸƒâ€â™‚ï¸</h3>
<pre data-id="id27"><code class="pycon" data-noescape="" data-trim="">&gt;&gt;&gt; print(ast.dump(tree, indent=3))
Module(
   body=[
      Expr(
         value=Call(
            func=Name(id='print', ctx=Load()),
            args=[
               Constant(value='é™å²¡')]))])</code></pre>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="ast-dump" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id26" role="doc-backlink">9</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#ast.dump" rel="noreferrer" target="_blank">https://docs.python.org/ja/3/library/ast.html#ast.dump</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><code class="docutils literal notranslate"><span class="pre">print("é™å²¡")</span></code> ã®ASTã‚’èª­ã‚€</h3>
<pre data-id="print-ast"><code class="default" data-line-numbers="1" data-noescape="" data-trim="">Module(
   body=[
      Expr(
         value=Call(
            func=Name(id='print', ctx=Load()),
            args=[
               Constant(value='é™å²¡')]))])
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#ast.Module" rel="noreferrer" target="_blank">ast.Module</a></h3>
<ul>
<li><p>Pythonã¯æ–‡ãŒã‚ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª <a class="footnote-reference brackets" href="#python-statements" id="id29" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> ã«ã¯ <a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#ast-statements" rel="noreferrer" target="_blank">æ–‡</a> ãŒæ¥ã‚‹</p>
<blockquote>
<div><p>é–¢æ•°å‘¼ã³å‡ºã—ã®ã‚ˆã†ãªå¼ãŒãã‚Œè‡ªèº«ã§æ–‡ã¨ãªã‚Šã€ï¼ˆ<a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#ast.Expr" rel="noreferrer" target="_blank">ast.Expr</a>ï¼‰</p>
</div></blockquote>
</li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="python-statements" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id29" role="doc-backlink">10</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://docs.python.org/ja/3/reference/simple_stmts.html" rel="noreferrer" target="_blank">å˜ç´”æ–‡</a>ãƒ»<a class="reference external" href="https://docs.python.org/ja/3/reference/compound_stmts.html" rel="noreferrer" target="_blank">è¤‡åˆæ–‡</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ã©ã‚“ãªå¼ï¼ˆæ–‡ï¼‰ã‹</h3>
<pre data-id="id30"><code class="default" data-line-numbers="4,5,6,7" data-noescape="" data-trim="">Module(
   body=[
      Expr(
         value=Call(
            func=Name(id='print', ctx=Load()),
            args=[
               Constant(value='é™å²¡')]))])
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#ast.Call" rel="noreferrer" target="_blank">ast.Call</a>ï¼šé–¢æ•°å‘¼ã³å‡ºã—</h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> ã«çµ„ã¿è¾¼ã¿é–¢æ•°ã® <code class="docutils literal notranslate"><span class="pre">print</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code> ã«ä½ç½®å¼•æ•°</p></li>
</ul>
<pre data-id="id31"><code class="default" data-noescape="" data-trim="">         value=Call(
            func=Name(id='print', ctx=Load()),
            args=[
               Constant(value='é™å²¡')]))])
</code></pre>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">æº–å‚™2ï¸âƒ£ Visitor ãƒ‘ã‚¿ãƒ¼ãƒ³</h2>
<ul class="simple">
<li><p>ã‚„ã‚ŠãŸã„ã“ã¨ï¼šæœ¨ã®ä¸­ã®ç‰¹å®šã®ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ãŸã„ï¼ˆä¾‹ï¼š<code class="docutils literal notranslate"><span class="pre">print</span></code> é–¢æ•°ï¼‰</p></li>
<li><p>æ“ä½œã‚’ <strong>è¨ªå•è€…</strong> ï¼ˆVisitorï¼‰ã«æ›¸ãã€ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¯è¨ªå•è€…ã‚’å—ã‘å…¥ã‚Œã‚‹ <a class="footnote-reference brackets" href="#gof-visitor-pattern" id="id32" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a></p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="gof-visitor-pattern" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id32" role="doc-backlink">11</a><span class="fn-bracket">]</span></span>
<p>ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«æ“ä½œã‚’æ›¸ãã®ã¨æ¯”ã¹ã¦ã€æ“ä½œã‚’è¿½åŠ ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚æ‹™ãƒ–ãƒ­ã‚° <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/entry/the-transcendent-book-chapter8-design-patterns-visitor" rel="noreferrer" target="_blank">èª­æ›¸&amp;å†™çµŒãƒ­ã‚° | #ã¡ã‚‡ã†ãœã¤æœ¬ ç¬¬8ç«  Visitorãƒ‘ã‚¿ãƒ¼ãƒ³</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#ast.NodeVisitor" rel="noreferrer" target="_blank">ast.NodeVisitor</a></h3>
<blockquote>
<div><p>æŠ½è±¡æ§‹æ–‡æœ¨ã‚’æ¸¡ã‚Šæ­©ã„ã¦ãƒ“ã‚¸ã‚¿ãƒ¼é–¢æ•°ã‚’è¦‹ã¤ã‘ãŸãƒãƒ¼ãƒ‰ã”ã¨ã«å‘¼ã³å‡ºã™ãƒãƒ¼ãƒ‰ãƒ»ãƒ“ã‚¸ã‚¿ãƒ¼ã®åŸºåº•ã‚¯ãƒ©ã‚¹ã§ã™ã€‚</p>
</div></blockquote>
<p><strong>ç¶™æ‰¿</strong> ã—ãŸã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã™ã‚‹</p>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ä¾‹ï¼š<code class="docutils literal notranslate"><span class="pre">print</span></code> ã‚’è¦‹ã¤ã‘ã‚‹</h3>
<pre data-id="print"><code class="python" data-noescape="" data-trim="">class PrintFinder(ast.NodeVisitor):
    def visit_Call(self, node):
        if isinstance(node.func, ast.Name) and node.func.id == "print":
            args = [arg.value for arg in node.args]
            print(f"Found print at line {node.lineno}, args {args}")
        self.generic_visit(node)
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">å®Ÿè¡Œçµæœ</h3>
<pre data-id="id34"><code class="python" data-noescape="" data-trim="">source = """\
print("é™å²¡")
len("é™å²¡")
print("æœ€é«˜")
"""
tree = ast.parse(source)
PrintFinder().visit(tree)
</code></pre>
<pre data-id="id34"><code class="txt" data-noescape="" data-trim="">Found print at line 1, args ['é™å²¡']
Found print at line 3, args ['æœ€é«˜']</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><code class="docutils literal notranslate"><span class="pre">PrintFinder.visit()</span></code></h3>
<ul class="simple">
<li><p>è¦ªã‚¯ãƒ©ã‚¹ <code class="docutils literal notranslate"><span class="pre">NodeVisitor</span></code> ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">visit</span></code> ã¯ <strong>ãƒãƒ¼ãƒ‰ã®ã‚¯ãƒ©ã‚¹åã‹ã‚‰ visit_ã‚¯ãƒ©ã‚¹å ãƒ¡ã‚½ãƒƒãƒ‰</strong> ã‚’å‘¼ã³å‡ºã™</p></li>
<li><p><a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#ast.NodeVisitor.visit" rel="noreferrer" target="_blank">https://docs.python.org/ja/3/library/ast.html#ast.NodeVisitor.visit</a></p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><code class="docutils literal notranslate"><span class="pre">NodeVisitor.visit()</span></code> ğŸƒâ€â™‚ï¸</h3>
<pre data-id="nodevisitor-visit"><code class="python" data-noescape="" data-trim="">class NodeVisitor(object):
    def visit(self, node):
        method = 'visit_' + node.__class__.__name__
        visitor = getattr(self, method, self.generic_visit)
        return visitor(node)</code></pre>
<p><a class="reference external" href="https://github.com/python/cpython/blob/v3.14.3/Lib/ast.py#L482-L516" rel="noreferrer" target="_blank">https://github.com/python/cpython/blob/v3.14.3/Lib/ast.py#L482-L516</a></p>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">visitã®ã‚¤ãƒ¡ãƒ¼ã‚¸</h3>
<a class="reference internal image-reference" href="../_images/visit-print-call.drawio.png"><img alt="../_images/visit-print-call.drawio.png" height="556" src="../_images/visit-print-call.drawio.png" width="321"/>
</a>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">é–¢æ•°å‘¼ã³å‡ºã—ãƒãƒ¼ãƒ‰ã«å¯¾ã™ã‚‹ <strong>visit_Callã‚’è¿½åŠ </strong></h3>
<pre data-id="visit-call"><code class="python" data-line-numbers="3" data-noescape="" data-trim="">class PrintFinder(ast.NodeVisitor):
    def visit_Call(self, node):
        if isinstance(node.func, ast.Name) and node.func.id == "print":
            args = [arg.value for arg in node.args]
            print(f"Found print at line {node.lineno}, args {args}")
        self.generic_visit(node)
</code></pre>
<pre data-id="visit-call"><code class="default" data-line-numbers="4,5,6,7" data-noescape="" data-trim="">Module(
   body=[
      Expr(
         value=Call(
            func=Name(id='print', ctx=Load()),
            args=[
               Constant(value='é™å²¡')]))])
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">å†å¸°çš„ã«visit</h3>
<pre data-id="id35"><code class="python" data-line-numbers="6" data-noescape="" data-trim="">class PrintFinder(ast.NodeVisitor):
    def visit_Call(self, node):
        if isinstance(node.func, ast.Name) and node.func.id == "print":
            args = [arg.value for arg in node.args]
            print(f"Found print at line {node.lineno}, args {args}")
        self.generic_visit(node)
</code></pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">generic_visit</span></code>ï¼šå­ãƒãƒ¼ãƒ‰ã® <code class="docutils literal notranslate"><span class="pre">visit</span></code> ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—</p></li>
</ul>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">ãƒ«ãƒ¼ãƒ«ã‚’æ›¸ãæº–å‚™ã€OKï¼Ÿ</h2>
<dl class="field-list simple">
<dt class="field-odd">æŠ½è±¡æ§‹æ–‡æœ¨<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">ast</span></code> ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ç¢ºèªã§ãã‚‹</p>
</dd>
<dt class="field-even">Visitorãƒ‘ã‚¿ãƒ¼ãƒ³<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">ast.NodeVisitor</span></code> ã‚’ç¶™æ‰¿ã€‚<code class="docutils literal notranslate"><span class="pre">visit_ãƒãƒ¼ãƒ‰ã®ã‚¯ãƒ©ã‚¹å</span></code> ã‚’å®Ÿè£…</p>
</dd>
</dl>
<p>ASTã®ãƒãƒ¼ãƒ‰ã‚’å·¡å›ã—ã¦ã€<strong>ç‰¹å®šã®æ¡ä»¶ã®ãƒãƒ¼ãƒ‰</strong> ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã¾ã™ï¼</p>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">ã€Œå¼•æ•°ã®å‹ãƒ’ãƒ³ãƒˆã‚’listã«ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€ã‚’æ›¸ã</h2>
<pre data-id="id36"><code class="python" data-noescape="" data-trim="">class ArgumentListTypeHintChecker(ast.NodeVisitor):
    def visit_arg(self, node):
        annotation = node.annotation
        if isinstance(annotation, ast.Subscript) and annotation.value.id == "list":
            as_is = f"{node.arg}: {annotation.value.id}[{annotation.slice.id}]"
            print(f"Fix type hint `{as_is}` at {node.lineno}:{node.col_offset}")
        self.generic_visit(node)
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">é–¢æ•°å®šç¾©ã®ASTï¼ˆæŠœç²‹ï¼‰</h3>
<pre data-id="id37"><code class="default" data-noescape="" data-trim="">FunctionDef(
   name='plus_one_ng',
   args=arguments(
      args=[
         arg(
            arg='numbers',
            annotation=Subscript(
               value=Name(id='list', ctx=Load()),
               slice=Name(id='int', ctx=Load()),
               ctx=Load()))]),
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#ast.FunctionDef" rel="noreferrer" target="_blank">ast.FunctionDef</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ast.arguments</span></code> ãŒé–¢æ•°ã®å¼•æ•°å…¨ä½“</p></li>
<li><p><strong>1ã¤1ã¤ã®å¼•æ•°</strong> ãŒ <a class="reference external" href="https://docs.python.org/ja/3/library/ast.html#ast.arg" rel="noreferrer" target="_blank">ast.arg</a></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">annotation</span></code> ã«å‹ãƒ’ãƒ³ãƒˆ</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><code class="docutils literal notranslate"><span class="pre">ast.arg</span></code> ã® <code class="docutils literal notranslate"><span class="pre">annotation</span></code></h3>
<pre data-id="ast-arg-annotation"><code class="default" data-line-numbers="7" data-noescape="" data-trim="">FunctionDef(
   name='plus_one_ng',
   args=arguments(
      args=[
         arg(
            arg='numbers',
            annotation=Subscript(
               value=Name(id='list', ctx=Load()),
               slice=Name(id='int', ctx=Load()),
               ctx=Load()))]),
</code></pre>
<ul class="simple">
<li><p><strong>ast.Subscript</strong>: ã‚¸ã‚§ãƒãƒªãƒƒã‚¯å‹ï¼ˆ <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">func(d:</span> <span class="pre">list[int])</span></code> ï¼‰</p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">å®Ÿè¡ŒçµæœğŸ™Œ</h3>
<pre data-id="id39"><code class="python" data-noescape="" data-trim="">def plus_one_ng(numbers: list[int]) -&gt; list[int]:
    return [n + 1 for n in numbers]

def plus_one_ok(numbers: Iterable[int]) -&gt; list[int]:
    return [n + 1 for n in numbers]</code></pre>
<pre data-id="id39"><code class="txt" data-noescape="" data-trim="">Fix type hint `numbers: list[int]` at 1:16</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><code class="docutils literal notranslate"><span class="pre">annotation</span></code> ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ ğŸƒâ€â™‚ï¸</h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: å‹ãƒ’ãƒ³ãƒˆãªã—ï¼ˆ <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">func(a)</span></code> ï¼‰</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ast.Name</span></code>: å˜ç´”ãªå‹ï¼ˆ <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">func(b:</span> <span class="pre">int)</span></code> ï¼‰</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ast.Attribute</span></code>: ä¿®é£¾åï¼ˆ <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">func(tree:</span> <span class="pre">ast.AST)</span></code> ï¼‰</p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">å°ã¾ã¨ã‚ğŸ¥Ÿ ãƒªãƒ³ã‚¿ã®ãƒ«ãƒ¼ãƒ«ã‚’Pythonã§æ›¸ã</h3>
<ul class="simple">
<li><p>ASTã¨Visitorãƒ‘ã‚¿ãƒ¼ãƒ³</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ast.NodeVisitor</span></code> ã‚’ç¶™æ‰¿ã—ã¦ <strong>visit_ãƒãƒ¼ãƒ‰ã®ã‚¯ãƒ©ã‚¹å</strong> ã‚’å®Ÿè£…</p></li>
<li><p>ã€Œå¼•æ•°ã®å‹ãƒ’ãƒ³ãƒˆã‚’listã«ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€ãƒ«ãƒ¼ãƒ«ã‚’Pythonã§å®Ÿè£…ã§ããŸ</p></li>
</ul>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">flake8ã«ãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ã™ã‚‹</h2>
<ul class="simple">
<li><p>Pythonè£½ãƒªãƒ³ã‚¿ <a class="reference external" href="https://github.com/PyCQA/flake8" rel="noreferrer" target="_blank">https://github.com/PyCQA/flake8</a></p></li>
</ul>
<ol class="arabic simple">
<li><p>å…ˆã®å®Ÿè£…ã‚’flake8ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«åˆã‚ã›ã‚‹ã ã‘</p></li>
<li><p>Pythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ã</p></li>
</ol>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">(1)flake8ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</h3>
<ul class="simple">
<li><p>ASTå‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼šflake8ãŒãƒ‘ãƒ¼ã‚¹æ¸ˆã¿ã® <code class="docutils literal notranslate"><span class="pre">ast.AST</span></code> ã‚’æ¸¡ã—ã¦ãã‚Œã‚‹</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__init__(self,</span> <span class="pre">tree:</span> <span class="pre">ast.AST)</span></code>: ASTã‚’å—ã‘å–ã‚‹</p></li>
</ul>
<pre data-id="id41"><code class="default" data-noescape="" data-trim="">class Flake8KotohaPlugin:
    def __init__(self, tree: ast.AST) -&gt; None:
        self._tree = tree
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">(1)flake8ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">run()</span></code> ãƒ¡ã‚½ãƒƒãƒ‰: 4-tuple <code class="docutils literal notranslate"><span class="pre">(è¡Œç•ªå·,</span> <span class="pre">åˆ—ç•ªå·,</span> <span class="pre">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸,</span> <span class="pre">å‹)</span></code> ã‚’ <code class="docutils literal notranslate"><span class="pre">yield</span></code></p></li>
<li><p>ãƒã‚§ãƒƒã‚«ãƒ¼ã¯ <code class="docutils literal notranslate"><span class="pre">print</span></code> ã™ã‚‹ä»£ã‚ã‚Šã« <code class="docutils literal notranslate"><span class="pre">self.errors</span></code> ãƒªã‚¹ãƒˆã¸ã®è“„ç©ã«å¤‰æ›´</p></li>
</ul>
<pre data-id="id41"><code class="default" data-noescape="" data-trim="">class Flake8KotohaPlugin:
    def run(self) -&gt; Generator[tuple[int, int, str, Type[Any]], None, None]:
        checker = ArgumentListTypeHintChecker()
        checker.visit(self._tree)

        for lineno, col_offset, message in checker.errors:
            yield (lineno, col_offset, message, type(self))
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">(2)ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ï¼ˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æ›¸ãæ–¹ï¼‰</h3>
<pre data-id="id42"><code class="default" data-noescape="" data-trim="">[project]
dependencies = ["flake8"]

[project.entry-points."flake8.extension"]
KTH = "kotoha_plugin:Flake8KotohaPlugin"
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">pylint ã§ã‚‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã—ã¦æ›¸ã‘ã‚‹ ğŸƒâ€â™‚ï¸</h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pylint-dev/pylint" rel="noreferrer" target="_blank">https://github.com/pylint-dev/pylint</a></p></li>
<li><p>æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªastã§ãªã <strong>astroid</strong> ã‚’ä½¿ã£ã¦ AST ã‚’è¡¨ç¾ <a class="footnote-reference brackets" href="#pylint-kotoha" id="id43" role="doc-noteref"><span class="fn-bracket">[</span>12<span class="fn-bracket">]</span></a></p></li>
</ul>
<pre data-id="pylint"><code class="console" data-noescape="" data-trim="">$ pylint --load_plugins kotoha_plugin use_iterable.py</code></pre>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="pylint-kotoha" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id43" role="doc-backlink">12</a><span class="fn-bracket">]</span></span>
<p>æ‹™ãƒ–ãƒ­ã‚° <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/entry/flake8-kotoha-experiment-pylint-checker-implementation" rel="noreferrer" target="_blank">pylint ã‚’ä½¿ã£ãŸç´è‘‰ã¡ã‚ƒã‚“ã€Œå¼•æ•°ã®å‹ãƒ’ãƒ³ãƒˆã‚’ list ã«ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ãŠã™ã™ã‚ï¼š<a class="reference external" href="https://2022.pycon.jp/timetable/?id=CNFPPT" rel="noreferrer" target="_blank">ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„è‡ªå‹•åŒ– Pylintã®ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œã‚ã†</a> ğŸƒâ€â™‚ï¸</h3>
<iframe allowfullscreen="true" class="speakerdeck-iframe" data-ratio="1.7777777777777777" frameborder="0" src="https://speakerdeck.com/player/dd2b52803bf14bd7a5d1b0cb67315cfb" style="border: 0px; background: rgba(0, 0, 0, 0.1) padding-box; margin: 0px; padding: 0px; border-radius: 6px; box-shadow: rgba(0, 0, 0, 0.2) 0px 5px 40px; width: 100%; height: auto; aspect-ratio: 560 / 315;" title="PyCon JP 2022/ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„è‡ªå‹•åŒ– Pylintã®ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œã‚ã†ã€"></iframe></section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">Rustè£½ãƒªãƒ³ã‚¿ã«ãƒ«ãƒ¼ãƒ«ã‚’ã©ã†è¿½åŠ ã™ã‚‹ã‹</h2>
<p>Pythonã§ãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‚‚ã®ã®...</p>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">Ruffï¼ˆå›³ã¯READMEã‚ˆã‚Šï¼‰</h3>
<ul>
<li><p><a class="reference external" href="https://github.com/astral-sh/ruff" rel="noreferrer" target="_blank">https://github.com/astral-sh/ruff</a></p>
<blockquote>
<div><p>An extremely fast Python linter and code formatter, written in Rust.</p>
</div></blockquote>
</li>
</ul>
<img alt="https://user-images.githubusercontent.com/1309177/232603514-c95e9b0f-6b31-43de-9a80-9e844173fd6a.svg" src="https://user-images.githubusercontent.com/1309177/232603514-c95e9b0f-6b31-43de-9a80-9e844173fd6a.svg"/>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">Astralã€ŒRuff ã ã‘ã‚ã‚Œã°ã„ã„ã§ã—ã‚‡ã€</h3>
<ul>
<li><p>æ•°ã€…ã®ãƒªãƒ³ã‚¿ãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ã‚’Ruffã« <strong>çµ±åˆ</strong></p>
<blockquote>
<div><p>Ruff can be used to replace Flake8 (plus dozens of plugins), Black, isort, pydocstyle, pyupgrade, autoflake, and more,</p>
</div></blockquote>
</li>
<li><p>ãƒ«ãƒ¼ãƒ«ã‚’å†å®Ÿè£…ã—ã€800è¶…ãˆã‚’ã‚«ãƒãƒ¼ <a class="footnote-reference brackets" href="#ruff-rules-doc" id="id46" role="doc-noteref"><span class="fn-bracket">[</span>13<span class="fn-bracket">]</span></a></p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="ruff-rules-doc" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id46" role="doc-backlink">13</a><span class="fn-bracket">]</span></span>
<p>ã€Œ<em>Ruff supports over 800 lint rules,</em>ã€ <a class="reference external" href="https://docs.astral.sh/ruff/rules/" rel="noreferrer" target="_blank">https://docs.astral.sh/ruff/rules/</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ã‚³ãƒãƒ³ãƒ‰ä¾‹ <a class="footnote-reference brackets" href="#ruff-command-article" id="id47" role="doc-noteref"><span class="fn-bracket">[</span>14<span class="fn-bracket">]</span></a></h3>
<pre data-id="id48"><code class="console" data-noescape="" data-trim="">uvx ruff format
uvx ruff check --fix --extend-select I
# ã¾ãŸã¯ uv format  # &gt;= 0.8.13</code></pre>
<p>æ˜¨æ—¥ã® <a class="reference external" href="https://github.com/astral-sh/ruff/releases/tag/0.15.2" rel="noreferrer" target="_blank">Ruff 0.15.2</a> ã‹ã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ«ãƒ¼ãƒ«ãŒ <strong>çˆ†å¢—</strong> ã—ã¦ã¾ã™</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="ruff-command-article" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id47" role="doc-backlink">14</a><span class="fn-bracket">]</span></span>
<p>æ‹™ãƒ–ãƒ­ã‚° <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/entry/ruff-as-python-formatter-two-commands" rel="noreferrer" target="_blank">Ruffã¯ format ã¨ check --fix ã®2ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">Ruffã«ã¯ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ©Ÿæ§‹ãŒç„¡ã„ğŸˆšï¸</h3>
<ul class="simple">
<li><p>ãƒ«ãƒ¼ãƒ«ã®è¿½åŠ ã¯ã€æœ¬å®¶ã¸ã®ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ¡ˆå†…ã•ã‚Œã‚‹ï¼ˆ<a class="reference external" href="https://github.com/astral-sh/ruff/blob/main/CONTRIBUTING.md" rel="noreferrer" target="_blank">CONTRIBUTING.md</a>ï¼‰</p></li>
<li><p><a class="reference external" href="https://github.com/astral-sh/ruff/issues/283" rel="noreferrer" target="_blank">Meta issue: plugin system #283</a> (2023/09 2å¹´åŠä»¥ä¸Šã‚ªãƒ¼ãƒ—ãƒ³ã€‚<em>æ”¾ç½®</em>ï¼Ÿ)</p></li>
<li><p>è‡ªåˆ†ã«å¿…è¦ãªãƒ«ãƒ¼ãƒ«ã‚’ <strong>æ‰‹å…ƒã§Ruffã«è¿½åŠ ã§ããªã„</strong> çŠ¶æ…‹</p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">Why Astral?</h3>
<ul class="simple">
<li><p>é«˜é€Ÿãƒ„ãƒ¼ãƒ«ã«æœ€å¤§ç´šã®æ„Ÿè¬ã‚’ç¤ºã—ã¤ã¤ã‚‚ã€ç‡ç›´ã«è¨€ã£ã¦å›°ã£ã¦ã¾ã™</p></li>
<li><p>æ‹™ãƒ–ãƒ­ã‚° <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/entry/is-ruff-superset-of-flake8-my-answer-is-no-202501" rel="noreferrer" target="_blank">Ruffã¯Flake8ã®å…¨ã¦ã®è¦ç´ ã‚’å«ã‚“ã§ã„ã‚‹ã€ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ</a> â€• å¦ï¼ˆäº’æ›ã§ãªã„ï¼‰</p></li>
<li><p><strong>é€Ÿã•ã‚’å„ªå…ˆã™ã‚‹ã¨ã€æ©Ÿèƒ½ã®è±Šã‹ã•ã‚’å¤±ã†</strong> ï¼ˆRuffã‚„Astralã¯ã‚‚ã£ã¨ã†ã¾ãç«‹ã¡å›ã‚Œã‚‹ã¯ãšï¼‰</p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">Ruff + ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ« ã‚’ã©ã†å®Ÿç¾ã™ã‚‹ã‹ï¼Ÿ</h3>
<ul class="simple">
<li><p>flake8ï¼ˆã‚„pylintï¼‰ã¨ã®ä½µç”¨ã¯ãªã„ã€‚ã›ã£ã‹ãã®é€Ÿã•ã‚’å¤±ã†</p></li>
<li><p><strong>é«˜é€Ÿã•ã‚’æãªã‚ãšã«ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’æ›¸ãæ–¹æ³•</strong> ã‚’æ±‚ã‚ã¦ã¾ã™ï¼ˆã‚¢ã‚¤ãƒ‡ã‚¢å‹Ÿé›†ã€‚å»Šä¸‹å¸Œæœ›ï¼‰</p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">IMOï¼šä»£æ›¿æ‰‹æ®µ</h3>
<ol class="upperalpha simple">
<li><p>ast-grep: Rustè£½ãƒ„ãƒ¼ãƒ«ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ <strong>YAML</strong> ã§æ›¸ã</p></li>
<li><p><strong>Rust</strong> ã§ç›´æ¥æ›¸ã„ã¦ã¿ã‚‹: RustPython/Parser</p></li>
</ol>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">ğŸ…°ï¸ ast-grep</h2>
<ul>
<li><p><a class="reference external" href="https://github.com/ast-grep/ast-grep" rel="noreferrer" target="_blank">https://github.com/ast-grep/ast-grep</a></p>
<blockquote>
<div><p>ast-grep is an abstract syntax tree based tool to search code by pattern code.</p>
</div></blockquote>
</li>
<li><p><strong>ASTã§grep</strong> ã§ãã‚‹ï¼</p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ä½¿ã„æ–¹ï¼ˆä¸€ä¾‹ï¼‰</h3>
<pre data-id="id50"><code class="console" data-noescape="" data-trim="">$ uvx --from ast-grep-cli ast-grep scan --rule ast-grep-kotoha.yaml examples.py</code></pre>
<p><a class="reference external" href="https://pypi.org/project/ast-grep-cli/" rel="noreferrer" target="_blank">https://pypi.org/project/ast-grep-cli/</a></p>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">YAMLã§ãƒ«ãƒ¼ãƒ«ã‚’æ›¸ã</h3>
<pre data-id="yaml"><code class="yaml" data-noescape="" data-trim="">id: do-not-use-list-as-typed-parameter
language: Python
rule:
  pattern:
    context: 'a: list[$TYPE]'
    selector: type
  inside:
    kind: typed_parameter
fix: Iterable[$TYPE]
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ast-grepã«ãŠã‘ã‚‹AST</h3>
<pre data-id="ast-grepast"><code class="python" data-noescape="" data-trim="">def plus_one_ng(numbers: list[str]) -&gt; list[int]: pass</code></pre>
<pre data-id="ast-grepast"><code class="default" data-noescape="" data-trim="">  (function_definition [0, 0] - [0, 54]
    name: (identifier [0, 4] - [0, 15])
    parameters: (parameters [0, 15] - [0, 35]
      (typed_parameter [0, 16] - [0, 34]
        (identifier [0, 16] - [0, 23])
        type: (type [0, 25] - [0, 34]
          (generic_type [0, 25] - [0, 34]
            (identifier [0, 25] - [0, 29])
            (type_parameter [0, 29] - [0, 34]
              (type [0, 30] - [0, 33]
                (identifier [0, 30] - [0, 33])))))))
</code></pre>
<p><a class="reference external" href="https://ast-grep.github.io/playground.html" rel="noreferrer" target="_blank">https://ast-grep.github.io/playground.html</a></p>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;"><code class="docutils literal notranslate"><span class="pre">list[]</span></code> ã¨ã„ã†å‹ãƒ’ãƒ³ãƒˆã«ãƒãƒƒãƒ</h3>
<pre data-id="id51"><code class="yaml" data-noescape="" data-trim="">rule:
  pattern:
    context: 'a: list[$TYPE]'
    selector: type
</code></pre>
<img alt="../_images/ast-grep-playground-list-type-hint.png" src="../_images/ast-grep-playground-list-type-hint.png"/>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">è¦ªãƒãƒ¼ãƒ‰ã®æŒ‡å®šã‚’è¿½åŠ </h3>
<p>typed_parameter ã®ç›´ä¸‹ã® type</p>
<pre data-id="id52"><code class="yaml" data-line-numbers="5,6" data-noescape="" data-trim="">rule:
  pattern:
    context: 'a: list[$TYPE]'
    selector: type
  inside:
    kind: typed_parameter
</code></pre>
<img alt="../_images/ast-grep-playground-list-typed-parameter.png" src="../_images/ast-grep-playground-list-typed-parameter.png"/>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ast-grepã¯å®Ÿã¯ <strong>tree-sitter</strong> ã«ã‚ˆã‚‹ ğŸƒâ€â™‚ï¸</h3>
<blockquote>
<div><p>ast-grep's core is an algorithm to search and replace code based on abstract syntax tree produced by tree-sitter.</p>
</div></blockquote>
<ul class="simple">
<li><p>tree-sitter ã¯å¤šè¨€èªå¯¾å¿œ</p></li>
<li><p><a class="reference external" href="https://tree-sitter.github.io/tree-sitter/" rel="noreferrer" target="_blank">https://tree-sitter.github.io/tree-sitter/</a></p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">tree-sitter ã‚¯ã‚¨ãƒªã®ä¾‹ <a class="footnote-reference brackets" href="#tree-sitter-blog" id="id53" role="doc-noteref"><span class="fn-bracket">[</span>15<span class="fn-bracket">]</span></a> ğŸƒâ€â™‚ï¸</h3>
<pre data-id="tree-sitter"><code class="scheme" data-noescape="" data-trim="">(typed_parameter
  (identifier) @param_name
  type: (type
    (generic_type
      (identifier) @type_name
      (type_parameter
        (type
          (identifier) @inner_type))))
  (#eq? @type_name "list"))
</code></pre>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="tree-sitter-blog" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id53" role="doc-backlink">15</a><span class="fn-bracket">]</span></span>
<p>æ‹™ãƒ–ãƒ­ã‚° <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/entry/tree-sitter-python-query-like-flake8-kotoha" rel="noreferrer" target="_blank">tree-sitterã§ã€é–¢æ•°ã®å¼•æ•°ã‚’listã§å‹ãƒ’ãƒ³ãƒˆã—ã¦ã„ã‚‹Pythonã‚³ãƒ¼ãƒ‰ã‚’ã‚¯ã‚¨ãƒªã™ã‚‹ğŸ”</a></p>
</aside>
</aside>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">ğŸ…±ï¸ ç™ºå±•ï¼šRustã§æ›¸ã</h2>
<ul class="simple">
<li><p>ã“ã®éƒ¨åˆ†ã ã‘Rustã®çŸ¥è­˜ã‚’å‰æã«ã—ã¾ã™</p></li>
<li><p>é›°å›²æ°—ã ã‘æ´ã‚“ã§ã„ãŸã ã‘ã‚Œã°ï¼</p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">RustPython/Parser</h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/RustPython/Parser" rel="noreferrer" target="_blank">https://github.com/RustPython/Parser</a></p></li>
<li><p>RustPythonãŒä½¿ã†Pythonãƒ‘ãƒ¼ã‚µï¼ˆRustè£½ï¼‰</p></li>
<li><p>Ruffã‚‚ã‹ã¤ã¦ä½¿ã£ã¦ã„ãŸ <a class="footnote-reference brackets" href="#ruff-040-blog" id="id55" role="doc-noteref"><span class="fn-bracket">[</span>16<span class="fn-bracket">]</span></a></p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="ruff-040-blog" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id55" role="doc-backlink">16</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://astral.sh/blog/ruff-v0.4.0" rel="noreferrer" target="_blank">https://astral.sh/blog/ruff-v0.4.0</a></p>
</aside>
</aside>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">Rustç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</h3>
<ul>
<li><p><a class="reference external" href="https://rustup.rs/" rel="noreferrer" target="_blank">rustup</a> ã§Rustç’°å¢ƒã‚’å°å…¥</p></li>
<li><p><strong class="command">cargo</strong> ã§Rustã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç®¡ç†</p>
<blockquote>
<div><ul class="simple">
<li><p>Astralã¯Pythonã«ãŠã‘ã‚‹cargoã¨ã—ã¦uvã‚’ææ¡ˆã—ã¦ã„ã‚‹</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">Pythonã‚³ãƒ¼ãƒ‰ã‚’Rustã§ãƒ‘ãƒ¼ã‚¹</h3>
<pre data-id="pythonrust"><code class="rust" data-noescape="" data-trim="">use rustpython_parser::{Parse, ast};

fn main() {
    let python_source = r#"
def plus_one_ng(numbers: list[int]) -&gt; list[int]:
    return [n + 1 for n in numbers]
"#;
    let ast = ast::Suite::parse(python_source, "&lt;embedded&gt;");
    assert!(ast.is_ok());
    println!("{:#?}", ast.unwrap());
}</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">RustPython/Parserã®AST</h3>
<pre data-id="rustpython-parserast"><code class="default" data-noescape="" data-trim="">        StmtFunctionDef {
            range: 1..86,
            name: Identifier(
                "plus_one_ng",
            ),
            args: Arguments {
                range: (),
                posonlyargs: [],
                args: [
                    ArgWithDefault {
                        range: (),
                        def: Arg {
                            range: 17..35,
                            arg: Identifier(
                                "numbers",
                            ),
                            annotation: Some(
                                Subscript(
                                    ExprSubscript {
                                        range: 26..35,
                                        value: Name(
                                            ExprName {
                                                range: 26..30,
                                                id: Identifier(
                                                    "list",
                                                ),
                                                ctx: Load,
                                            },
                                        ),
                                        slice: Name(
                                            ExprName {
                                                range: 31..34,
                                                id: Identifier(
                                                    "int",
                                                ),
                                                ctx: Load,
                                            },
                                        ),
                                        ctx: Load,
                                    },
                                ),
                            ),
                            type_comment: None,
                        },
                        default: None,
                    },
                ],
</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">rustpython-astã®visitor feature</h3>
<pre data-id="rustpython-astvisitor-feature"><code class="rust" data-noescape="" data-trim="">use rustpython_ast::{Arguments, Visitor};

struct KotohaVisitor&lt;'a&gt; {
    source: &amp;'a str,
}

impl Visitor for KotohaVisitor&lt;'_&gt; {
    fn visit_arguments(&amp;mut self, node: Arguments) {
        // ã“ã“ã«å‡¦ç†ã‚’æ›¸ã
    }
}</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">Pythonå®Ÿè£…ã¨åŒæ§˜ã®æŒ‡æ‘˜</h3>
<pre data-id="id57"><code class="python" data-noescape="" data-trim="">def plus_one_ng(numbers: list[int]) -&gt; list[int]:
    return [n + 1 for n in numbers]

def plus_one_ok(numbers: Iterable[int]) -&gt; list[int]:
    return [n + 1 for n in numbers]</code></pre>
<pre data-id="id57"><code class="console" data-noescape="" data-trim="">$ cargo run -q
Fix type hint `numbers: list[int]` at 2:17</code></pre>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">å°ã¾ã¨ã‚ğŸ¥Ÿ Rustè£½ãƒªãƒ³ã‚¿ã«ãƒ«ãƒ¼ãƒ«ã‚’ã©ã†è¿½åŠ ã™ã‚‹ã‹</h3>
<ul class="simple">
<li><p>ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒãªã„Ruffã‚’ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã¨ä¸€ç·’ã«å‹•ã‹ã—ãŸã„</p></li>
<li><p><strong>ast-grep</strong>ï¼šRustè£½ãƒ„ãƒ¼ãƒ«ã§ã€YAMLã§ãƒ«ãƒ¼ãƒ«ã‚’æ›¸ã</p></li>
<li><p>RustPython/Parserã‚’ä½¿ã£ã¦ <strong>Rustã‚‚æ›¸ã„ã¦ã¿ãŸ</strong> ï¼ˆç”ŸæˆAIã‚µãƒãƒ¼ãƒˆï¼‰</p></li>
</ul>
</section>
</section>
<section>
<section>
<h2 style="word-break: keep-all; overflow-wrap: break-word;">ã¾ã¨ã‚ğŸŒ¯ Pythonã®ãƒªãƒ³ã‚¿ã®ãƒ«ãƒ¼ãƒ«ã‚’ä½œã‚ã†</h2>
<ul class="simple">
<li><p>Pythonã‚³ãƒ¼ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ«ã®æŒ‡æ‘˜ã¯ãƒªãƒ³ã‚¿ã«ä»»ã›ã‚ˆã†</p></li>
<li><p>è‡ªåˆ†ãŒæ¬²ã—ã„ãƒ«ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã¨ãã¯ <strong>è‡ªåˆ†ã§æ›¸ã“ã†</strong></p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">Pythonã§ãƒªãƒ³ã‚¿ã®ãƒ«ãƒ¼ãƒ«ã‚’æ›¸ã</h3>
<ul class="simple">
<li><p>æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªastã§æŠ½è±¡æ§‹æ–‡æœ¨ã‚’è¦‹ãªãŒã‚‰ <strong>æŒ‡æ‘˜ã—ãŸã„Pythonãƒãƒ¼ãƒ‰ã®å‡¦ç†ã‚’visitorã«è¿½åŠ </strong></p></li>
<li><p>æ—¢å­˜ã®ãƒªãƒ³ã‚¿ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ã—ã¦ãƒ«ãƒ¼ãƒ«è¿½åŠ </p></li>
<li><p>ğŸ’¡ãƒ«ãƒ¼ãƒ«ãŒæ›¸ã‘ãŸã‚‰ã€CLIã‹ã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ãªã©ã‚’è¶³ã—ã¦ã„ã‘ã°ãƒªãƒ³ã‚¿ãŒä½œã‚Œã‚‹ã˜ã‚ƒã‚“ï¼</p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">Ruff + ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«</h3>
<ul class="simple">
<li><p>ast-grepï¼ˆ<strong>YAML</strong> ã§ãƒ«ãƒ¼ãƒ«ã‚’æ›¸ãï¼‰</p></li>
<li><p>ã“ã®æ©Ÿä¼šã«Rustã‚’æ›¸ã„ã¡ã‚ƒãŠã†ğŸŒŸ</p></li>
<li><p>Astralã¯ã•ã™ãŒã«ãã‚ãã‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ğŸ™ï¼ˆç§ã‚‚æŒ‘ã¿ã¾ã™ï¼‰</p></li>
</ul>
</section>
<section>
<h3 style="word-break: keep-all; overflow-wrap: break-word;">ã”æ¸…è´ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</h3>
<p>Happy Python Developmentâ™ª</p>
</section>
</section>

        </div>
    </div>
    
    <script src="../_static/revealjs/dist/reveal.js"></script>
    
    
      <script src="../_static/revealjs/plugin/highlight/highlight.js"></script>
      <script src="../_static/revealjs/plugin/notes/notes.js"></script>
      <script src="../_static/revealjs/plugin/copycode/copycode.js"></script>
      
    
    <script>
        var revealjsConfig = new Object();
        Object.assign(revealjsConfig, {"controls": true, "progress": true, "history": true, "center": true, "transition": "none", "slideNumber": "c/t", "scrollActivationWidth": null});
        
        
        
          revealjsConfig.plugins = [
            RevealHighlight,RevealNotes,CopyCode,
          ];
        
        // More info https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize(revealjsConfig);
    </script>

  </body>
</html>